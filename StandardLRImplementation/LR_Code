import numpy as np
import pandas as pd
import seaborn as sns
import matplotlib.pyplot as plt
from sklearn.model_selection import train_test_split,cross_val_score
from sklearn.linear_model import LinearRegression
from sklearn.metrics import mean_absolute_error

data=pd.read_csv("Salary_Data.csv")

data.head()

data.size

data.shape

data.info()

data.describe()

data.isnull().sum()

plt.scatter(data['YearsExperience'], data['Salary'])
plt.show()

train_data,test_data = train_test_split(data,test_size=0.3,shuffle=True,random_state=42)

train_x, train_y = np.array(train_data['YearsExperience']).reshape(-1,1),np.array(train_data['Salary']).reshape(-1,1)
test_x, test_y = np.array(test_data['YearsExperience']).reshape(-1,1), np.array(test_data['Salary']).reshape(-1,1)

test_x.shape

from sklearn.preprocessing import StandardScaler
scaler = StandardScaler()
train_x = scaler.fit_transform(train_x)

model = LinearRegression()
model.fit(train_x,train_y)

model.score(train_x,train_y)

score = cross_val_score(model,train_x,train_y,scoring='neg_mean_absolute_error',cv=3)
score = (-score)

score.mean()

test_x = scaler.transform(test_x)
test_predict = model.predict(test_x)
score = mean_absolute_error(test_y,test_predict)
score

model.score(test_x,test_y)
